<!DOCTYPE html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>Attendance</title>
  <meta name="description" content="Attendance">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  <!-- <link rel="stylesheet" href="css/styles.css?v=1.0"> -->
  <style>
    #events {
      margin-bottom: 1em;
      padding: 1em;
      background-color: #f6f6f6;
      border: 1px solid #999;
      border-radius: 3px;
      height: 100px;
      overflow: auto;
    }
    /* .bg-green {
      background-color: green;
    } */
    .selected {
      filter: brightness(85%);
    }
  </style>
</head>

<body>

  <label for="category">Choose a category:</label>

  <select name="category" id="category-selector">
  </select>

  <table id="my_table" class="display">
    <thead>
        <tr>
            <th>Name</th>
            <th>Date 1</th>
            <th>Date 2</th>
            <th>Date 3</th>
            <th>Date 4</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Name example 1</td>
            <td>1 2</td>
            <td>1 3</td>
            <td>1 4</td>
            <td>1 5</td>
        </tr>
        <tr>
            <td>Name example 2</td>
            <td>2 2</td>
            <td>2 3</td>
            <td>2 4</td>
            <td>2 5</td>
        </tr>
    </tbody>
  </table>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.min.js"></script>
  <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/select/1.3.1/js/dataTables.select.min.js"></script>
  <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/buttons/1.6.4/js/dataTables.buttons.min.js"></script>
  <!-- <script src="js/scripts.js"></script> -->
  <script>
    $(document).ready( function () {
      // fetch categories
      var categories = {
        'cat_default': '',
        'cat_red': 'red',
        'cat_green': 'green'
      }

      // populate select dropdown
      for (key in categories) {
        $('#category-selector').append(
          $('<option>').attr('value', key).html(categories[key])
        );
      }

      var table = $('#my_table').DataTable( {
        dom: 'Bfrtip',
        select: {
          style: 'os',
          items: 'cell'
        },
        buttons: [
          {
            text: 'Apply',
            action: function () {
              var selectedCells = table.cells( { selected: true } );
              var categorySelection = $('#category-selector').val();
              selectedCells.every( function () {
                var node = $(this.node());
                if (! node.hasClass("sorting_1")) {
                  var color = categories[categorySelection];
                  if (color) {
                    node.css('background-color', color);
                  } else {
                    node.css('background-color', '');
                  }
                }
              });
            }
          }
        ]
      });

    });
  </script>
</body>
</html>
